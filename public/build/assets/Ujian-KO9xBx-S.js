import{r as d,m as C,j as a,L as E}from"./app--PlKIPqO.js";function L({ujian:i,questions:c,durasi:u}){const[r,o]=d.useState(0),[l,h]=d.useState({}),[f,p]=d.useState(u*60),[x,j]=d.useState(!1),{post:w,csrfToken:N}=C();d.useEffect(()=>{const e=localStorage.getItem(`ujian-${i.id}-answers`);e&&h(JSON.parse(e))},[i.id]),d.useEffect(()=>{localStorage.setItem(`ujian-${i.id}-answers`,JSON.stringify(l))},[l,i.id]),d.useEffect(()=>{const e=setInterval(()=>{p(s=>s<=1?(clearInterval(e),v(),0):s-1)},1e3);return()=>clearInterval(e)},[]);const v=()=>{alert("Waktu habis! Jawaban Anda akan disubmit."),g()},m=(e,s)=>{const t={...l,[e]:s};console.log("Jawaban diperbarui:",t),h(t)},y=(e,s)=>{const t=l[e]||[];t.includes(s)?h({...l,[e]:t.filter(n=>n!==s)}):h({...l,[e]:[...t,s]})},g=()=>{const e=JSON.parse(localStorage.getItem(`ujian-${i.id}-answers`))||{};console.log("Jawaban yang dikirim:",e),w(`/ujian/${i.id}/submit`,{_token:N,answers:e})},S=()=>{r<c.length-1&&o(r+1)},$=()=>{r>0&&o(r-1)},k=()=>{confirm("Apakah Anda yakin ingin mengakhiri ujian?")&&g()},_=e=>{const s=Math.floor(e/60),t=e%60;return`${s.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},A=e=>{if(e.tipe_pertanyaan==="pilihan_ganda")return a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.pertanyaan}),["a","b","c","d","e"].map(s=>{const t=e[`pilihan_${s}`],n=e[`pilihan_${s}_gambar`];return!t&&!n?null:a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("label",{children:[a.jsx("input",{type:"radio",name:`question-${e.id}`,value:s,checked:l[e.id]===s,onChange:()=>m(e.id,s)}),t&&a.jsx("span",{children:t}),n&&a.jsx("img",{src:`/storage/${n}`,alt:`Pilihan ${s}`,className:"w-16 h-16 object-cover"})]})},s)})]});if(e.tipe_pertanyaan==="opsi_jawaban")return a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.pertanyaan}),["a","b","c","d","e"].map(s=>{var b;const t=e[`pilihan_${s}`],n=e[`pilihan_${s}_gambar`];return!t&&!n?null:a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",name:`question-${e.id}`,value:s,checked:((b=l[e.id])==null?void 0:b.includes(s))||!1,onChange:()=>y(e.id,s)}),t&&a.jsx("span",{children:t}),n&&a.jsx("img",{src:`/storage/${n}`,alt:`Pilihan ${s}`,className:"w-16 h-16 object-cover"})]})},s)})]});if(e.tipe_pertanyaan==="benar_salah")return a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:e.pertanyaan}),a.jsx("div",{children:a.jsxs("label",{children:[a.jsx("input",{type:"radio",name:`question-${e.id}`,value:"true",checked:l[e.id]==="true",onChange:()=>m(e.id,"true")}),"Benar"]})}),a.jsx("div",{children:a.jsxs("label",{children:[a.jsx("input",{type:"radio",name:`question-${e.id}`,value:"false",checked:l[e.id]==="false",onChange:()=>m(e.id,"false")}),"Salah"]})})]})};return a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 p-4",children:[a.jsx(E,{title:`Ujian: ${i.nama}`}),a.jsxs("div",{className:"fixed top-4 right-4 lg:static bg-red-100 text-red-600 p-4 rounded-lg shadow-md border border-red-300",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Sisa Waktu"}),a.jsx("p",{className:"text-2xl font-bold",children:_(f)})]}),a.jsx("div",{className:"flex-1 p-4 bg-white shadow-md rounded-lg border border-gray-200",children:A(c[r])}),a.jsx("div",{className:`fixed lg:static top-0 right-0 h-full lg:h-auto bg-white shadow-lg lg:shadow-none border lg:border-none transition-transform duration-300 ${x?"translate-x-0":"translate-x-full"} lg:translate-x-0 w-64 lg:w-auto`,children:a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Nomor Soal"}),a.jsx("div",{className:"grid grid-cols-5 gap-2",children:c.map((e,s)=>a.jsx("button",{className:`p-2 rounded ${r===s?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"}`,onClick:()=>o(s),children:s+1},s))})]})}),a.jsx("button",{className:"lg:hidden fixed bottom-4 right-4 bg-blue-600 text-white p-3 rounded-full shadow-lg",onClick:()=>j(!x),children:x?"Tutup Soal":"Lihat Soal"}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsx("button",{className:"px-4 py-2 bg-gray-600 text-white rounded disabled:bg-gray-300",onClick:$,disabled:r===0,children:"Sebelumnya"}),r===c.length-1?a.jsx("button",{className:"px-4 py-2 bg-red-600 text-white rounded",onClick:k,children:"Akhiri Ujian"}):a.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:S,children:"Selanjutnya"})]})]})}export{L as default};
